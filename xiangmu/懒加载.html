<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<script src="jquery_1.12.4.min.js"></script>
	<style>
		*{margin: 0;padding: 0;list-style-type: none;}
		.list{
			width: 1200px;
			margin: 50px auto;
			position: relative;
		}
		.list li{
			width: calc(25% - 20px);
			margin: 10px;
			height: 420px;
			float: left;
			background-color: #ccc;
		}
		.list img{
			width: 100%;
			height: 100%;
			opacity: 0;
			transition: .4s;
		}
	</style>
</head>
<body>
	<div id="box" v-lee="">
		<ul class="list"></ul>
	</div>
</body>
<script src="vue.js"></script>
<script src="vue-resource.js"></script>
<script>
	Vue.directive('lee', {
		inserted(dom, data) {
			var arr = ['https://photo.tuchong.com/1502782/f/165873571.jpg', 'https://photo.tuchong.com/1502782/f/479004593.jpg', 'https://photo.tuchong.com/3262232/f/90179442.jpg', 'https://photo.tuchong.com/1502782/f/356386727.jpg', 'https://photo.tuchong.com/1528557/f/548931500.jpg', 'https://photo.tuchong.com/959614/f/8871267.jpg', 'https://photo.tuchong.com/3262232/f/532743983.jpg', 'https://photo.tuchong.com/3451538/f/497879064.jpg', 'https://photo.tuchong.com/1502782/f/61474741.jpg', 'https://photo.tuchong.com/3451538/f/435881805.jpg', 'https://photo.tuchong.com/3262232/f/651887432.jpg', 'https://photo.tuchong.com/1834467/f/7883219.jpg', 'https://photo.tuchong.com/959614/f/8871260.jpg', 'https://photo.tuchong.com/5469328/f/586614698.jpg', 'https://photo.tuchong.com/3451538/f/93194277.jpg', 'https://photo.tuchong.com/2463054/f/18203129.jpg', 'https://photo.tuchong.com/1038102/f/18739079.jpg', 'https://photo.tuchong.com/363828/f/11458861.jpg', 'https://photo.tuchong.com/1502782/f/61474741.jpg', 'https://photo.tuchong.com/1319696/f/18575761.jpg', 'https://photo.tuchong.com/1834467/f/7883221.jpg', 'https://photo.tuchong.com/1834467/f/7883220.jpg', 'https://photo.tuchong.com/363828/f/11458864.jpg', 'https://photo.tuchong.com/3353838/f/226101129.jpg', 'https://photo.tuchong.com/6453118/f/552601448.jpg', 'https://photo.tuchong.com/363828/f/11443861.jpg', 'https://photo.tuchong.com/1777202/f/30652497.jpg', 'https://photo.tuchong.com/1157099/f/421201932.jpg', 'https://photo.tuchong.com/2356656/f/441845280.jpg', 'https://photo.tuchong.com/1502782/f/297666432.jpg', 'https://photo.tuchong.com/3262232/f/127338357.jpg', 'https://photo.tuchong.com/1483878/f/33315100.jpg', 'https://photo.tuchong.com/2356656/f/441845280.jpg', 'https://photo.tuchong.com/3262232/f/223610751.jpg', 'https://photo.tuchong.com/1157099/f/38143928.jpg', 'https://photo.tuchong.com/410709/f/19611599.jpg', 'https://photo.tuchong.com/1554764/f/190449592.jpg', 'https://photo.tuchong.com/1618033/f/9657897.jpg', 'https://photo.tuchong.com/1502782/f/505677703.jpg', 'https://photo.tuchong.com/455350/f/210765715.jpg', 'https://photo.tuchong.com/1016407/f/322635617.jpg', 'https://photo.tuchong.com/5362112/f/641992617.jpg', 'https://photo.tuchong.com/1184765/f/20548204.jpg', 'https://photo.tuchong.com/1834467/f/7883218.jpg', 'https://photo.tuchong.com/1707218/f/10269482.jpg', 'https://photo.tuchong.com/4968587/f/235668840.jpg', 'https://photo.tuchong.com/3262232/f/569771804.jpg', 'https://photo.tuchong.com/2299484/f/14795479.jpg', 'https://photo.tuchong.com/4968587/f/75105663.jpg', 'https://photo.tuchong.com/363828/f/11433261.jpg', 'https://photo.tuchong.com/1502782/f/189335470.jpg', 'https://photo.tuchong.com/2299484/f/14795473.jpg', 'https://photo.tuchong.com/1502782/f/43780048.jpg', 'https://photo.tuchong.com/363828/f/11433262.jpg', 'https://photo.tuchong.com/363828/f/11433267.jpg', 'https://photo.tuchong.com/1502782/f/466683283.jpg', 'https://photo.tuchong.com/363828/f/11456393.jpg', 'https://photo.tuchong.com/363828/f/11456394.jpg', 'https://photo.tuchong.com/1502782/f/365823949.jpg', 'https://photo.tuchong.com/3262232/f/632554252.jpg', 'https://photo.tuchong.com/3262232/f/187826954.jpg', 'https://photo.tuchong.com/2299484/f/14795478.jpg', 'https://photo.tuchong.com/1502782/f/43911188.jpg', 'https://photo.tuchong.com/1707218/f/10269481.jpg', 'https://photo.tuchong.com/1502782/f/238486944.jpg', 'https://photo.tuchong.com/1502782/f/476775914.jpg', 'https://photo.tuchong.com/1502782/f/559941118.jpg', 'https://photo.tuchong.com/1502782/f/278005704.jpg', 'https://photo.tuchong.com/1502782/f/559941118.jpg', 'https://photo.tuchong.com/1502782/f/321194004.jpg', 'https://photo.tuchong.com/1502782/f/452134951.jpg', 'https://photo.tuchong.com/3281883/f/630261560.jpg', 'https://photo.tuchong.com/1502782/f/444270570.jpg', 'https://photo.tuchong.com/1319696/f/18575764.jpg'];
		var oUl = document.querySelector('.list');
		var aLi = [];

		arr.forEach((item, index)=>{
			var oLi = document.createElement('li');
			var oImg = document.createElement('img');
			oImg.setAttribute('data-src', item);
			oLi.appendChild(oImg);
			oUl.appendChild(oLi);
			aLi.push(oLi);
		})

		function offTop(obj){
			var _top = obj.offsetTop;
			while (obj.parentNode != document) {
				_top += obj.parentNode.offsetTop;
				obj = obj.parentNode;
			}
			return _top;
		}
		// console.log(offTop(aLi[1]));

		// var aLi = oUl.querySelectorAll('li');

		var ch = document.documentElement.clientHeight;
		// var _top = offTop(aLi[1]);
		// var _top = aLi[1].getBoundingClientRect();

		onscroll = function () {
			var st = document.documentElement.scrollTop || document.body.scrollTop;

			for(var i=0,len=arr.length;i<len;i++){
				if(st+ch>=offTop(aLi[i])){
					var oImg = aLi[i].querySelector('img');
					oImg.src = oImg.getAttribute('data-src');
					oImg.onload = function(){
						this.style.opacity = 1;
					}
				}
			}
		}
			},
		})
		new Vue({
			el: "#box",
		})
</script>
</html>